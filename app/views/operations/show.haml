- content_for :title do
  = "#{resource}"
- content_for :subnavigation do
  %ul.subnavigation
    - if permitted_to? :edit, resource
      %li= link_to "Edit operation details", edit_resource_path
    - if resource.registration.present?
      %li= link_to "Return to registration", registration_path(resource.registration)
    - if permitted_to? :destroy, resource
      %li= link_to "Delete operation", resource_path, :method => :delete, :confirm => "Are you sure? This will remove all data and xray records for this operation. This action cannot be undone."
      
.operation
  .summary
    %h2 Operation
    %dl
      %dt Registration ID
      %dd= resource.registration_id
      %dt Body Part
      %dd= resource.body_part
      %dt Procedure
      %dd= resource.procedure
      %dt Primary Surgeon
      %dd= resource.primary_surgeon
      %dt Secondary Surgeon
      %dd= resource.secondary_surgeon
      %dt Anesthesiologist
      %dd= resource.anesthesiologist
      %dt Date
      %dd= resource.date
      %dt Approach
      %dd= resource.approach
      %dt Difficulty
      %dd= resource.difficulty
      %dt Graft
      %dd= resource.graft
      %dt Ambulatory Order
      %dd= resource.ambulatory_order
  .notes
    %h2 Notes
    %p= simple_format(resource.notes)
  .implant
    %h2 Implant
    %ul.subnavigation
      - if resource.implant.blank?
        %li= link_to "Add implant", new_operation_implant_path(resource)
      - else
        %li= link_to "Edit implant details", operation_implant_path(resource)
  .section
    .pre_op
      %h2 Pre-Operation
      .diagnosis
        #diagnosis_list
          = render :partial => "diagnoses/inline", :object => resource.diagnosis, :as => :diagnosis, :locals => { :options => { :size => :tiny, :remote => true } }
    .post_op
      %h2 Post-Operation
      %ul.subnavigation
        %li= link_to "Add an x-ray", new_operation_xray_path(resource)
      - if resource.xrays.present?
        .xrays
          - resource.xrays.each do |xray|
            = xray_preview(xray, :size => :tiny)